
# 🚀 Azure Infrastructure Automation

This repository automates the provisioning of Azure infrastructure using **Terraform**, **ARM templates**, and **GitHub Actions**.

---

## 📌 Core Use Cases

- 🔹 **Create a Subscription - Coding challenge**
  
  [![Deploy to Azure](https://aka.ms/deploytoazurebutton)]()

- 🔹 **Create a New Management Group**

  [![Deploy to Azure](https://aka.ms/deploytoazurebutton)]()

- 🔹 **Create a Resource Group**

  [![Deploy to Azure](https://aka.ms/deploytoazurebutton)]()

---

## 📁 Directory Structure

```
.
├── terraform/                # Terraform modules and configs
├── arm-templates/           # Azure ARM templates (JSON)
├── .github/workflows/       # CI/CD automation via GitHub Actions
└── README.md                # Project overview and usage
```

---

## 🚀 Getting Started

### Prerequisites
- [Azure CLI](https://learn.microsoft.com/en-us/cli/azure/install-azure-cli)
- [Terraform](https://developer.hashicorp.com/terraform/downloads)
- Azure account and credentials

### Terraform Deployment

```bash
cd terraform
terraform init
terraform plan
terraform apply
```

---

## ⚙️ GitHub Actions CI/CD Workflow

This project leverages **modular GitHub Actions workflows** to orchestrate secure, reusable, and environment-aware deployments of Azure infrastructure using Terraform.

### 🌐 Workflow 1: `Plan and Apply` (Main Orchestrator)

**File**: `.github/workflows/Plan-Apply-Main.yml`  
**Trigger**: Manually via GitHub UI (`workflow_dispatch`)

- Prompts the user to select a target environment (e.g., `Dev`, `Prod`)
- Executes:
  - ✅ `terraform plan` (via `plan.yml`)
  - ✅ `terraform apply` (via `apply.yml`)
- Ensures infrastructure changes are explicitly reviewed and confirmed

---

### 🛠️ Workflow 2: `Terraform Plan` (Reusable)

**File**: `.github/workflows/plan.yml`  
**Called by**: `Plan-Apply-Main.yml`

- **Initializes Terraform** with remote backend configuration
- Runs `terraform plan` using the correct environment `.tfvars`
- Outputs an execution plan to be validated before deployment
- Authenticates securely using **Azure OIDC tokens**

**Highlights:**
- Modular and reusable
- Zero hardcoded secrets; uses GitHub `secrets` + `env` variables

---

### 🚀 Workflow 3: `Terraform Apply` (Reusable)

**File**: `.github/workflows/apply.yml`  
**Called by**: `Plan-Apply-Main.yml`

- Uses the plan file generated by `terraform plan`
- Applies infrastructure changes using `terraform apply`
- Posts back deployment results to pull requests (via `pull-requests: write`)
- Ensures that only authorized and validated changes go live

**Features:**
- OIDC-enabled Azure authentication
- Fully reusable and safe for multi-environment deployments
- Supports remote state management via secure backend configuration

---

### 🔐 Security & Best Practices

- ☁️ **OIDC Authentication** with Azure – no need for long-lived secrets
- 💬 Pull request feedback via GitHub Comments
- 📦 Environment-specific deployment support (`Dev`, `Prod`, etc.)
- 🔁 Modular workflows for **reuse, clarity, and separation of concerns**

---

## 📚 Resources

- [Terraform Azure Provider Docs](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)
- [ARM Template Guide](https://learn.microsoft.com/en-us/azure/azure-resource-manager/templates/overview)
- [GitHub Actions](https://docs.github.com/en/actions)

---

## 🙌 Contributions

Contributions are welcome! Feel free to fork the repo and create a pull request with your enhancements.

---

## 👤 Author

**Rohit** – [GitHub](https://github.com/rohitcivi)

---

⭐ *Star this repo if you found it useful!*
