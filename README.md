
# ğŸš€ Azure Infrastructure Automation

This repository automates the provisioning of Azure infrastructure using **Terraform**, **ARM templates**, and **GitHub Actions**.

---

## ğŸ“Œ Core Use Cases

- ğŸ”¹ **Create a Subscription - Coding challenge**
  
  [![Deploy to Azure](https://aka.ms/deploytoazurebutton)]()

- ğŸ”¹ **Create a New Management Group**

  [![Deploy to Azure](https://aka.ms/deploytoazurebutton)]()

- ğŸ”¹ **Create a Resource Group**

  [![Deploy to Azure](https://aka.ms/deploytoazurebutton)]()

---

## ğŸ“ Directory Structure

```
.
â”œâ”€â”€ terraform/                # Terraform modules and configs
â”œâ”€â”€ arm-templates/           # Azure ARM templates (JSON)
â”œâ”€â”€ .github/workflows/       # CI/CD automation via GitHub Actions
â””â”€â”€ README.md                # Project overview and usage
```

---

## ğŸš€ Getting Started

### Prerequisites
- [Azure CLI](https://learn.microsoft.com/en-us/cli/azure/install-azure-cli)
- [Terraform](https://developer.hashicorp.com/terraform/downloads)
- Azure account and credentials

### Terraform Deployment

```bash
cd terraform
terraform init
terraform plan
terraform apply
```

---

## âš™ï¸ GitHub Actions CI/CD Workflow

This project leverages **modular GitHub Actions workflows** to orchestrate secure, reusable, and environment-aware deployments of Azure infrastructure using Terraform.

### ğŸŒ Workflow 1: `Plan and Apply` (Main Orchestrator)

**File**: `.github/workflows/Plan-Apply-Main.yml`  
**Trigger**: Manually via GitHub UI (`workflow_dispatch`)

- Prompts the user to select a target environment (e.g., `Dev`, `Prod`)
- Executes:
  - âœ… `terraform plan` (via `plan.yml`)
  - âœ… `terraform apply` (via `apply.yml`)
- Ensures infrastructure changes are explicitly reviewed and confirmed

---

### ğŸ› ï¸ Workflow 2: `Terraform Plan` (Reusable)

**File**: `.github/workflows/plan.yml`  
**Called by**: `Plan-Apply-Main.yml`

- **Initializes Terraform** with remote backend configuration
- Runs `terraform plan` using the correct environment `.tfvars`
- Outputs an execution plan to be validated before deployment
- Authenticates securely using **Azure OIDC tokens**

**Highlights:**
- Modular and reusable
- Zero hardcoded secrets; uses GitHub `secrets` + `env` variables

---

### ğŸš€ Workflow 3: `Terraform Apply` (Reusable)

**File**: `.github/workflows/apply.yml`  
**Called by**: `Plan-Apply-Main.yml`

- Uses the plan file generated by `terraform plan`
- Applies infrastructure changes using `terraform apply`
- Posts back deployment results to pull requests (via `pull-requests: write`)
- Ensures that only authorized and validated changes go live

**Features:**
- OIDC-enabled Azure authentication
- Fully reusable and safe for multi-environment deployments
- Supports remote state management via secure backend configuration

---

### ğŸ” Security & Best Practices

- â˜ï¸ **OIDC Authentication** with Azure â€“ no need for long-lived secrets
- ğŸ’¬ Pull request feedback via GitHub Comments
- ğŸ“¦ Environment-specific deployment support (`Dev`, `Prod`, etc.)
- ğŸ” Modular workflows for **reuse, clarity, and separation of concerns**

---

## ğŸ“š Resources

- [Terraform Azure Provider Docs](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)
- [ARM Template Guide](https://learn.microsoft.com/en-us/azure/azure-resource-manager/templates/overview)
- [GitHub Actions](https://docs.github.com/en/actions)

---

## ğŸ™Œ Contributions

Contributions are welcome! Feel free to fork the repo and create a pull request with your enhancements.

---

## ğŸ‘¤ Author

**Rohit** â€“ [GitHub](https://github.com/rohitcivi)

---

â­ *Star this repo if you found it useful!*
